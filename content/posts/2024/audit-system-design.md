---
title: "审计追踪服务的设计"
draft: true
date: 2023-12-10T21:26:40+08:00
categories: [Cloud Native Computing]
tags: [audit]
aliases: [/posts/audit-system-design/]
description: ""
---

## 什么是审计追踪（Audit Trail）服务？

> 维基百科：审计轨迹（英语：Audit trail、Audit log），也译作审计追踪、审计跟踪、审计日志、文件日志或轨迹纪录等名称，是一种作为信息系统审计手段的与安全相关的时间顺序记录、记录集和/或目的地和记录来源，它们提供了在任何时候影响特定操作，程序的活动顺序的文件证据或事件。 审计记录通常来自一些活动，例如：金融交易、科学研究和医疗保健数据交易，或个人、系统、账号以及其他实体的通信等活动。 透过对系统上的活动作时间顺序的纪录，从而监察系统是否存在违规的活动，协助审核人员快速的找出相关的交易资料。

## 审计追踪服务应该具备哪些能力？

1. 日志内容不可篡改。
2. 日志链结构完整：不可任意添加或删除单独的日志条目。
3. 当日志链从末尾被截断，应该保护日志免受截断攻击（Truncation Attacks）。
4. 系统的加密服务应该尽早初始化，以减少未受保护的日志。
5. 服务重启/关闭不应导致审核日志不一致。如果服务因紧急情况而关闭，审核日志应该是可验证的。
6. 密钥安全性：加密密钥（用于计算完整性检查）应存储在专用密钥存储中，并在内存中驻留最短的时间。
7. 性能：能够在几秒钟内验证受保护日志的生产量。如果审核日志的验证是一个自动监控过程，那么性能会直接影响事件检测和反应时间（MTTD、MTTR）。
8. 日志轮换友好性：审核日志应与分布式系统典型的日志轮换策略兼容。

## 截断攻击

在日志审计系统中，截断攻击（Truncation Attacks）是一种针对日志的安全漏洞，攻击者通过截断或删除日志条目来篡改或隐藏关键信息。这种攻击可能会导致对系统的安全性和完整性的威胁，因为日志是用于监控系统行为和提供取证证据的重要组成部分。为了防止截断攻击，可以采取以下措施：

- 加密日志：使用加密技术对日志进行保护，确保只有授权用户能够访问和修改日志。
- 完整性检查：在日志条目中添加完整性检查，以便在验证日志时能够检测到任何篡改或截断。
- 访问控制：限制对日志的访问权限，只有授权用户才能查看和修改日志。
- 定期备份：定期备份日志，以防止攻击者删除或修改所有的日志条目。
- 监测和响应：及时监测日志的变化，并对异常活动进行响应。如果发现日志条目被删除或修改，应立即进行调查，并采取适当的措施来保护系统的安全性和完整性。

## 审计追踪涉及的行业标准

常见的工业标准有 IEC62443、NIST SP 800-92。

## 开源的设计方案

### Auditd

### AWS Cloud Trail

### ...

##
